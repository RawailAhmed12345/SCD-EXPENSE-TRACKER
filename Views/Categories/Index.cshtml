@model List<ExpenseTracker.Models.Category>

@{
    ViewData["Title"] = "Categories";
    var categoryCounts = ViewBag.CategoryCounts as Dictionary<int, int> ?? new Dictionary<int, int>();
}

<div class="flex justify-between items-center mb-4">
    <div>
        <h1 class="mb-1">Categories</h1>
        <p style="color: var(--text-secondary);">Manage expense categories</p>
    </div>
    <a href="/Categories/Create" class="btn btn-primary">
        <i class="fas fa-plus"></i>
        Add Custom Category
    </a>
</div>

<div class="grid grid-cols-4 gap-md">
    @foreach (var category in Model)
    {
        var expenseCount = categoryCounts.ContainsKey(category.Id) ? categoryCounts[category.Id] : 0;
        
        <div class="card">
            <div class="flex items-center gap-md mb-3">
                <div style="width: 50px; height: 50px; border-radius: var(--radius-md); background: @category.Color; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem;">
                    <i class="fas @category.Icon"></i>
                </div>
                <div style="flex: 1;">
                    <h4 style="margin: 0;">@category.Name</h4>
                    @if (category.IsDefault)
                    {
                        <span class="badge badge-primary" style="font-size: 0.7rem;">Default</span>
                    }
                    else
                    {
                        <span class="badge badge-success" style="font-size: 0.7rem;">Custom</span>
                    }
                </div>
            </div>

            <div style="padding: 0.75rem; background: var(--bg-secondary); border-radius: var(--radius-md); margin-bottom: 1rem;">
                <div class="flex items-center gap-sm">
                    <i class="fas fa-receipt" style="color: var(--text-tertiary);"></i>
                    <span style="color: var(--text-secondary);">@expenseCount expense@(expenseCount != 1 ? "s" : "")</span>
                </div>
            </div>

            @if (!category.IsDefault)
            {
                <div class="flex gap-sm">
                    <a href="/Categories/Edit/@category.Id" class="btn btn-sm btn-secondary flex-1">
                        <i class="fas fa-edit"></i> Edit
                    </a>
                    <form asp-action="Delete" asp-route-id="@category.Id" method="post" style="flex: 1;" onsubmit="return confirm('Delete this category?');">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn btn-sm btn-danger" style="width: 100%;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </form>
                </div>
            }
        </div>
    }
</div>

@if (!Model.Any())
{
    <div class="card text-center" style="padding: 3rem;">
        <i class="fas fa-tags fa-3x mb-3" style="color: var(--text-tertiary);"></i>
        <h3>No Categories</h3>
        <p style="color: var(--text-secondary);">Categories help organize your expenses</p>
    </div>
}
